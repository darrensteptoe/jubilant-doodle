<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Field Path Engine â€” Darren Steptoe Consulting</title>
<meta content="Internal field planning dashboard." name="description"/>
<meta content="strict-origin-when-cross-origin" name="referrer"/>
<meta content="light dark" name="color-scheme"/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&amp;family=IBM+Plex+Sans:wght@300;400;500;600&amp;display=swap" rel="stylesheet"/>
<link href="./styles-shell.css" rel="stylesheet"/>
<link href="./styles.css" rel="stylesheet"/>
</head>
<body>
<!-- â”€â”€ TOPBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<header class="topbar-new">
<div class="brand-new">
<span class="brand-name-new">Field Path Engine</span>
<span class="chip-new" id="buildStamp">build</span>
<span class="chip-new chip-status" id="selfTestGate">UNVERIFIED</span>
</div>

<div class="topbar-right">
<label class="toggle-pill" title="Show training explanations for each section">
<input hidden="" id="toggleTraining" type="checkbox"/>
<span class="toggle-dot-new"></span>
      Training
    </label>
<div class="divider-new"></div>
<select class="btn-top-new" id="restoreBackup" title="Restore one of the last 5 auto-backups">
<option value="">Restore backupâ€¦</option>
</select>
<label class="toggle-pill" title="Strict import mode">
<input hidden="" id="toggleStrictImport" type="checkbox"/>
<span class="toggle-dot-new"></span>
      Strict import
    </label>
<div class="divider-new"></div>
<button class="btn-top-new" id="btnCopySummary" type="button">Copy Summary</button>
<button class="btn-top-new" id="btnExportCsv" type="button">Export CSV</button>
<button class="btn-top-new" id="btnDiagnostics" type="button">Diagnostics</button>
<button class="btn-top-new btn-top-danger" id="btnResetAll" type="button">Reset</button>
<!-- legacy hidden dark toggle kept for JS compatibility -->
<input hidden="" id="toggleDark" type="checkbox"/>
<input hidden="" id="toggleAdvDiagLegacy" type="checkbox"/>
</div>
</header>
<div class="banner warn" hidden="" id="importHashBanner">Snapshot hash differs from exported hash.</div>
<div class="banner warn" hidden="" id="importWarnBanner"></div>
<!-- â”€â”€ APP SHELL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="app-shell">
<!-- LEFT: Stage navigation rail -->
<nav aria-label="Planning stages" class="stage-nav-new"><div class="nav-group-label-new">Setup</div><button class="nav-item-new active" data-stage="setup" onclick="switchStage(this, 'setup')">
<span class="nav-num-new" data-num="1">1</span>
<span class="nav-label-new">Race setup</span>
</button><button class="nav-item-new" data-stage="universe" onclick="switchStage(this, 'universe')">
<span class="nav-num-new" data-num="2">2</span>
<span class="nav-label-new">Universe</span>
</button><button class="nav-item-new" data-stage="structure" onclick="switchStage(this, 'structure')">
<span class="nav-num-new" data-num="6">6</span>
<span class="nav-label-new">Electorate structure</span>
</button><div class="nav-group-label-new">Strategy</div><button class="nav-item-new" data-stage="ballot" onclick="switchStage(this, 'ballot')">
<span class="nav-num-new" data-num="3">3</span>
<span class="nav-label-new">Ballot test</span>
</button><button class="nav-item-new" data-stage="gotv" onclick="switchStage(this, 'gotv')">
<span class="nav-num-new" data-num="5">5</span>
<span class="nav-label-new">GOTV / turnout</span>
</button><div class="nav-group-label-new">Execution</div><button class="nav-item-new" data-stage="capacity" onclick="switchStage(this, 'capacity')">
<span class="nav-num-new" data-num="4">4</span>
<span class="nav-label-new">Capacity</span>
</button><div class="nav-group-label-new">Analysis</div><button class="nav-item-new" data-stage="results" onclick="switchStage(this, 'results')">
<span class="nav-num-new" data-num="7">7</span>
<span class="nav-label-new">Results &amp; risk</span>
</button><button class="nav-item-new" data-stage="roi" onclick="switchStage(this, 'roi')">
<span class="nav-num-new" data-num="8">8</span>
<span class="nav-label-new">Budget &amp; ROI</span>
</button><button class="nav-item-new" data-stage="checks" onclick="switchStage(this, 'checks')">
<span class="nav-num-new" data-num="9">9</span>
<span class="nav-label-new">Checks &amp; guardrails</span>
</button><div class="nav-group-label-new">Decisions</div><button class="nav-item-new" data-stage="scenarios" onclick="switchStage(this, 'scenarios')">
<span class="nav-num-new">â€”</span>
<span class="nav-label-new">Scenarios</span>
</button><button class="nav-item-new" data-stage="decisions" onclick="switchStage(this, 'decisions')">
<span class="nav-num-new">â€”</span>
<span class="nav-label-new">Decision sessions</span>
</button><button class="nav-item-new" data-stage="integrity" onclick="switchStage(this, 'integrity')">
<span class="nav-num-new">â€”</span>
<span class="nav-label-new">Integrity &amp; export</span>
</button></nav>
<!-- CENTER: Active stage content -->
<main class="stage-main-new"><div class="context-bar-new"><div class="topbar-center">
<span class="scenario-label-new">Active scenario</span>
<input class="scenario-input-new" id="scenarioName" placeholder="Scenario nameâ€¦" type="text"/>
</div><span class="context-hint-new">(name is saved in snapshot exports)</span></div>
<!-- â”€â”€ STAGE: setup â”€â”€ -->
<section class="stage-new active-stage" id="stage-setup">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 1</span>
<span class="stage-title-new">Race setup</span>
</div>
<p class="stage-sub-new">Establish the planning context â€” race type, election date, and mode. Every downstream number depends on this frame.</p>
<div class="training-panel-new" id="train-setup">
<div class="training-hd-new" onclick="toggleTrainPanel('train-setup')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Race Setup</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>Sets the planning context. Race type loads sensible defaults â€” a state house race and a mayoral race have different universe sizes, realistic capacity, and tactic mix. Election date drives timeline feasibility in later stages.</p>
<div class="training-rule-new">Scenario name â†’ saved with export<br/>Race type â†’ default band widths<br/>Election date â†’ weeks remaining auto-calc<br/>Mode â†’ persuasion vs turnout emphasis</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Common mistakes</div>
<ul>
<li>Using "Federal" template for a state leg race â€” band widths will be too tight</li>
<li>Leaving election date blank then forgetting to set weeks remaining manually</li>
<li>Setting mode to Late-start before you know your capacity constraints</li>
</ul>
<div class="training-caution-new">A plan is only meaningful relative to time constraints. Set election date first â€” everything else scales from it.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<!-- EXISTING CONTENT: Scenario card -->
<div class="card card-section phase-setup">
<div class="card-head card-header"><h2 class="card-title">Scenario</h2></div>
</div>
<div class="grid2">
<div class="field">
<label class="label" for="raceType">Race template</label>
<select class="select" id="raceType">
<option value="federal">Federal</option>
<option selected="" value="state_leg">State legislative</option>
<option value="municipal">Municipal / ward</option>
<option value="county">County / regional</option>
</select>
<div class="help" data-help="Template sets conservative default ranges. You can override anything.">
<span class="help-title">What this is</span>
<span class="help-text">Select a baseline assumptions profile (turnout band width defaults, etc.).</span>
</div>
</div>
<div class="field">
<label class="label" for="electionDate">Election date</label>
<input class="input" id="electionDate" type="date"/>
<div class="help" data-help="Used to estimate weeks remaining. You can override weeks manually below.">
<span class="help-title">Why it matters</span>
<span class="help-text">Timeline affects later production planning. In early use, treat as reference only.</span>
</div>
</div>
<div class="field">
<label class="label" for="weeksRemaining">Weeks remaining (override)</label>
<input class="input" id="weeksRemaining" min="0" placeholder="auto" step="1" type="number"/>
<div class="help" data-help="If blank, the dashboard estimates based on election date.">
<span class="help-title">If unsure</span>
<span class="help-text">Leave blank; you can set it later when production planning is added.</span>
</div>
</div>
<div class="field">
<label class="label" for="mode">Mode</label>
<select class="select" id="mode">
<option selected="" value="persuasion">Persuasion-first (default)</option>
<option value="late_start">Late-start / turnout-heavy</option>
</select>
<div class="help" data-help="Mode influences defaults later. Core math remains the same.">
<span class="help-title">What this changes</span>
<span class="help-text">In later phases, persuasion-first emphasizes persuasion volume before GOTV surge.</span>
</div>
</div>
</div>
</div></section>

<!-- â”€â”€ STAGE: universe â”€â”€ -->
<section class="stage-new" id="stage-universe">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 2</span>
<span class="stage-title-new">Universe</span>
</div>
<p class="stage-sub-new">Define the population and scale. Every vote count, cost per vote, and plan size depends on this number.</p>
<div class="training-panel-new" id="train-universe">
<div class="training-hd-new" onclick="toggleTrainPanel('train-universe')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Universe</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>Universe is the denominator for everything. Turnout votes = Universe Ã— turnout %. Persuasion universe = Universe Ã— persuasion %. Being off by 20% changes plan size by 20%.</p>
<div class="training-rule-new">Registered: most defensible, largest number<br/>Active (voted 1+ recent): smaller, higher quality<br/>Likely voters: smallest, most predictive</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Realistic ranges (state leg)</div>
<ul>
<li><strong>Rural district:</strong> 12,000â€“25,000 registered</li>
<li><strong>Suburban district:</strong> 30,000â€“60,000 registered</li>
<li><strong>Urban district:</strong> 40,000â€“80,000 registered</li>
</ul>
<div class="training-caution-new">Always note your source. If you revisit in 6 weeks you need to know whether this came from the voter file, SOS, or a guess.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="card-head card-header">
<h2 class="card-title">Universe (registration or expected voters)</h2>
<div class="help-text">Define the size of the electorate youâ€™re modeling (registration or expected voters). Be consistent with turnout assumptions.</div></div>
<div class="grid2">
<div class="field">
<label class="label" for="universeBasis">Universe basis</label>
<select class="select" id="universeBasis">
<option selected="" value="registered">Registered (default)</option>
<option value="active">Active (advanced)</option>
</select>
<div class="help" data-help="Registered is most publicly defensible. Active can be used when file hygiene is strong.">
<span class="help-title">Best practice</span>
<span class="help-text">Use Registered in client-facing work unless Active is clearly sourced and agreed.</span>
</div>
</div>
<div class="field">
<label class="label" for="universeSize">Universe size (U)</label>
<input class="input" id="universeSize" min="0" placeholder="e.g., 52000" step="1" type="number"/>
<div class="help" data-help="U is the base for turnout votes and persuasion universe.">
<span class="help-title">How itâ€™s used</span>
<span class="help-text">Turnout votes = U Ã— turnout %. Persuasion universe = U Ã— persuasion %.</span>
</div>
</div>
<div class="field span2">
<label class="label" for="sourceNote">Source note (optional)</label>
<input class="input" id="sourceNote" placeholder="e.g., VAN export dated 2026-02-01 or Elections dept file" type="text"/>
</div>
</div>
</div><div class="card card-section phase-candidates">
</div>
</section>
<!-- â”€â”€ STAGE: ballot â”€â”€ -->
<section class="stage-new" id="stage-ballot">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 3</span>
<span class="stage-title-new">Ballot test</span>
</div>
<p class="stage-sub-new">Establish baseline support and undecided distribution. Persuasion math has no anchor without this.</p>
<div class="training-panel-new" id="train-ballot">
<div class="training-hd-new" onclick="toggleTrainPanel('train-ballot')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Ballot Test</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>The ballot test sets your starting position. Candidate shares + undecided must sum to 100%. Undecided handling is one of the biggest hidden assumptions in field planning â€” it determines how "movable" voters are allocated.</p>
<div class="training-rule-new">Proportional: undecided breaks like committed voters<br/>Conservative against you: undecided breaks toward opponents<br/>User-defined: you set the split explicitly</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Common mistakes</div>
<ul>
<li>Using internal polling without weighting â€” internal polls skew toward your supporters</li>
<li>Setting undecided too low (real undecideds are usually 15â€“30% in competitive races)</li>
<li>Choosing "proportional" when the race has a strong incumbent â€” undecideds usually break against incumbents</li>
</ul>
<div class="training-caution-new">Undecided allocation is a primary source of volatility in multi-candidate races. Run both conservative and proportional to see the range.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="card-head card-header">
<h2 class="card-title">Ballot test (vote landscape)</h2>
<div class="card-actions">
<button class="btn btn-link" id="btnAddCandidate" type="button">Add candidate</button>
</div>
</div>
<div class="field">
<label class="label" for="yourCandidate">You are</label>
<select class="select" id="yourCandidate"></select>
</div>
<div class="table-wrap">
<div class="table-scroll"><table aria-label="Candidate support table" class="table">
<thead>
<tr>
<th>Name</th>
<th class="num">Support %</th>
<th></th>
</tr>
</thead>
<tbody id="candTbody"></tbody>
<tfoot>
<tr>
<td class="muted">Undecided</td>
<td class="num"><input class="input input-sm num" id="undecidedPct" max="100" min="0" step="0.1" type="number"/></td>
<td></td>
</tr>
<tr>
<td class="muted"><strong>Total</strong></td>
<td class="num"><strong id="supportTotal">â€”</strong></td>
<td></td>
</tr>
</tfoot>
</table></div>
</div>
<div class="grid2">
<div class="field">
<label class="label" for="undecidedMode">Undecided break</label>
<select class="select" id="undecidedMode">
<option selected="" value="proportional">Proportional</option>
<option value="user_defined">User-defined split</option>
<option value="against">Conservative against you</option>
<option value="toward">Conservative toward you</option>
</select>
<div class="help" data-help="Undecided allocation is a primary source of volatility in multi-candidate races.">
<span class="help-title">Best practice</span>
<span class="help-text">Stress-test against you. Donâ€™t rely on a friendly break.</span>
</div>
</div>
<div class="field" hidden="" id="userSplitWrap">
<label class="label">User-defined undecided split %</label>
<div class="user-split" id="userSplitList"></div>
<div class="note">Must sum to 100% across candidates.</div>
</div>
</div>
<div class="banner warn" hidden="" id="candWarn"></div>
</div><div class="card card-section phase-p3">
<div class="card-head card-header">
<h2 class="card-title">Turnout baseline (recent comparable cycles)</h2>
<div class="help-text">Use two recent comparable cycles to set a baseline and uncertainty band. This drives volatility in simulation.</div></div>
<div class="grid3">
<div class="field">
<label class="label" for="turnoutA">Cycle A turnout %</label>
<input class="input" id="turnoutA" max="100" min="0" placeholder="e.g., 39" step="0.1" type="number"/>
<div class="help" data-help="Comparable cycle means similar election type (midterm vs presidential; primary vs general).">
<span class="help-title">If unsure</span>
<span class="help-text">Pick the closest two cycles by election type and district boundaries.</span>
</div>
</div>
<div class="field">
<label class="label" for="turnoutB">Cycle B turnout %</label>
<input class="input" id="turnoutB" max="100" min="0" placeholder="e.g., 43" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="bandWidth">Band width (Â±)</label>
<input class="input" id="bandWidth" max="25" min="0" placeholder="e.g., 4" step="0.5" type="number"/>
<div class="help" data-help="Creates Best/Expected/Worst turnout scenarios around your 2-cycle average.">
<span class="help-title">Typical</span>
<span class="help-text">Â±3 to Â±5 is common. Keep it modest unless a unique cycle is expected.</span>
</div>
</div>
<div class="field span3 inline-metrics">
<div class="metric">
<div class="metric-k">Expected turnout %</div>
<div class="metric-v" id="turnoutExpected">â€”</div>
</div>
<div class="metric">
<div class="metric-k">Best / Worst turnout %</div>
<div class="metric-v" id="turnoutBand">â€”</div>
</div>
<div class="metric">
<div class="metric-k">Votes per 1% turnout</div>
<div class="metric-v" id="votesPer1pct">â€”</div>
</div>
</div>
</div>
</div><div class="card card-section phase-persuasion">
</div>
</section>
<!-- â”€â”€ STAGE: capacity â”€â”€ -->
<section class="stage-new" id="stage-capacity">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 4</span>
<span class="stage-title-new">Capacity</span>
</div>
<p class="stage-sub-new">Define staff, volunteer capacity, and contact rates. This is the ceiling on your entire plan.</p>
<div class="training-panel-new" id="train-capacity">
<div class="training-hd-new" onclick="toggleTrainPanel('train-capacity')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Capacity Planning</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>Capacity is the ceiling on your plan. This stage converts your staff and volunteer resources into weekly contact attempts, then checks whether that production can close your persuasion gap before Election Day.</p>
<div class="training-rule-new">Organizers:      1â€“4 per state leg race<br/>Doors/hour:      12â€“22 (experienced canvasser)<br/>Calls/hour:      14â€“28<br/>Contact rate:    20â€“35% doors / 8â€“18% phones<br/>Vol multiplier:  1.0â€“2.0Ã— (weak to strong program)</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Common mistakes</div>
<ul>
<li>Using 15+ doors/hour without accounting for turf density or door quality</li>
<li>Setting volunteer multiplier to 2.0Ã— before the volunteer program exists</li>
<li>Ignoring that production falls in the final 2 weeks due to GOTV shift</li>
</ul>
<div class="training-caution-new">Most campaigns overestimate contact rate by 30â€“40% in early planning. Start conservative â€” you can always revise up when you have real data from the organizer log.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="card-head card-header">
<h2 class="card-title">Persuadable universe (movable)</h2>
</div>
<div class="grid2">
<div class="field">
<label class="label" for="persuasionPct">Persuasion % of universe</label>
<input class="input" id="persuasionPct" max="100" min="0" placeholder="e.g., 30" step="0.1" type="number"/>
<div class="help" data-help="A modeling assumption: portion of registered voters who are not locked and could move.">
<span class="help-title">If unsure</span>
<span class="help-text">Use 30% for competitive/open; 25% for incumbent race; higher for chaotic municipal fields.</span>
</div>
</div>
<div class="field">
<label class="label" for="earlyVoteExp">Early vote % of turnout (Expected)</label>
<input class="input" id="earlyVoteExp" max="100" min="0" placeholder="e.g., 38" step="0.1" type="number"/>
<div class="help" data-help="Used as a risk lever; later phases will model chase and timeline compression more deeply.">
<span class="help-title">Risk lever</span>
<span class="help-text">Higher early vote compresses persuasion window and increases early workload.</span>
</div>
</div>
</div>
</div>
<div class="card card-section" id="weeklyOpsCard">
<div class="card-head card-header">
<h2 class="card-title">This week plan</h2>
<div class="help-text">A single operational view: what you need this week vs what your current team capacity can actually execute.</div>
</div>
<div class="subgrid">
<div class="mini">
<div class="mini-k">Goal support IDs (net)</div>
<div class="mini-v" id="wkGoal">â€”</div>
<div class="mini-s">Uses manual goal if set, otherwise persuasion need</div>
</div>
<div class="mini">
<div class="mini-k">Conversations / week</div>
<div class="mini-v" id="wkConvosPerWeek">â€”</div>
<div class="mini-s">Goal Ã· support rate Ã· weeks remaining</div>
</div>
<div class="mini">
<div class="mini-k">Attempts / week</div>
<div class="mini-v" id="wkAttemptsPerWeek">â€”</div>
<div class="mini-s">Conversations Ã· contact rate</div>
</div>
</div>
<div class="subgrid" style="margin-top:10px;">
<div class="mini">
<div class="mini-k">Capacity / week</div>
<div class="mini-v" id="wkCapacityPerWeek">â€”</div>
<div class="mini-s" id="wkCapacityBreakdown">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Gap / week</div>
<div class="mini-v" id="wkGapPerWeek">â€”</div>
<div class="mini-s">Required attempts âˆ’ capacity</div>
</div>
<div class="mini">
<div class="mini-k">Primary constraint</div>
<div class="mini-v" id="wkConstraint">â€”</div>
<div class="mini-s" id="wkConstraintNote">â€”</div>
</div>
</div>
<div class="banner warn" hidden="" id="wkBanner" style="margin-top:10px;"></div>
<div class="note">This uses your Phase 2 rates (support/contact) and Phase 3 capacity inputs (organizers, hours, doors/hr, calls/hr, channel split). It is a planning summary, not a CRM.</div>
<hr aria-hidden="true" class="sectionRule" style="margin:12px 0;"/>
<div class="card-subtitle">Weekly execution status</div>
<div class="subgrid" style="margin-top:10px;">
<div class="mini">
<div class="mini-k">Required convos / week</div>
<div class="mini-v" id="wkReqConvosWeek">â€”</div>
<div class="mini-s">From the plan</div>
</div>
<div class="mini">
<div class="mini-k">Actual convos (last 7)</div>
<div class="mini-v" id="wkActConvos7">â€”</div>
<div class="mini-s" id="wkActConvosNote">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Convos gap</div>
<div class="mini-v" id="wkGapConvos">â€”</div>
<div class="mini-s"><span class="tag" id="wkConvosPaceTag">â€”</span></div>
</div>
<div class="mini">
<div class="mini-k">Required attempts / week</div>
<div class="mini-v" id="wkReqAttemptsWeek">â€”</div>
<div class="mini-s">From the plan</div>
</div>
<div class="mini">
<div class="mini-k">Actual attempts (last 7)</div>
<div class="mini-v" id="wkActAttempts7">â€”</div>
<div class="mini-s" id="wkActAttemptsNote">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Attempts gap</div>
<div class="mini-v" id="wkGapAttempts">â€”</div>
<div class="mini-s"><span class="tag" id="wkAttemptsPaceTag">â€”</span></div>
</div>
</div>
<div class="subgrid" style="margin-top:10px;">
<div class="mini">
<div class="mini-k">Required door attempts / week</div>
<div class="mini-v" id="wkReqDoorAttemptsWeek">â€”</div>
<div class="mini-s">Based on channel split</div>
</div>
<div class="mini">
<div class="mini-k">Required call attempts / week</div>
<div class="mini-v" id="wkReqCallAttemptsWeek">â€”</div>
<div class="mini-s">Based on channel split</div>
</div>
<div class="mini">
<div class="mini-k">Implied convos / week</div>
<div class="mini-v" id="wkImpliedConvosWeek">â€”</div>
<div class="mini-s" id="wkImpliedConvosNote">â€”</div>
</div>
</div>
<div class="subgrid" style="margin-top:10px;">
<div class="mini">
<div class="mini-k">Pace finish (convos)</div>
<div class="mini-v" id="wkFinishConvos">â€”</div>
<div class="mini-s">Pace-Based Projection (Not Monte Carlo)</div>
</div>
<div class="mini">
<div class="mini-k">Pace finish (attempts)</div>
<div class="mini-v" id="wkFinishAttempts">â€”</div>
<div class="mini-s">Pace-Based Projection (Not Monte Carlo)</div>
</div>
<div class="mini">
<div class="mini-k">Pace status</div>
<div class="mini-v" id="wkPaceStatus">â€”</div>
<div class="mini-s" id="wkPaceNote">â€”</div>
</div>
</div>
<div class="banner warn" hidden="" id="wkExecBanner" style="margin-top:10px;"></div>
</div>
<div class="card card-section" id="weeklyOpsLeversCard">
<div class="card-head card-header">
<h2 class="card-title">Constraints &amp; levers</h2>
<div class="help-text">What is actually binding right now, and which knobs move the gap fastest (rough, local estimates).</div>
</div>
<div class="note" id="wkLeversIntro">â€”</div>
<div class="note" id="wkBestMovesIntro">Best 3 moves â€” impact per unit:</div>
<ul class="bullets" id="wkBestMovesList"></ul>
<div class="table-wrap" style="margin-top:10px;">
<table aria-label="Constraints and levers" class="table">
<thead>
<tr>
<th>Lever</th>
<th class="num">Impact</th>
<th>Cost unit</th>
<th class="num">Efficiency</th>
<th>Apply</th>
</tr>
</thead>
<tbody id="wkLeversTbody"></tbody>
</table>
</div>
<div class="note" id="wkLeversFoot">These are one-step estimates around current inputs. They are meant for weekly operating decisions, not full sensitivity mapping.</div>
</div>
<div class="card card-section" id="weeklyOpsActionsCard">
<div class="card-head card-header">
<h2 class="card-title">Recommended actions</h2>
<div class="help-text">A short list of practical next moves derived from the levers above.</div>
</div>
<div class="wkActionBar">
<button class="btn btn-sm" disabled="" id="wkUndoActionBtn" type="button">Undo last applied action</button>
<div aria-live="polite" class="mini-s" id="wkUndoActionMsg"></div>
</div>
<ul class="bullets" id="wkActionsList"></ul>
<div class="note">This is guidance under your current assumptions. If you change goal, rates, or capacity, re-check the plan.</div>
</div>
<div class="card card-section" id="weeklyOpsFreshnessCard">
<div class="card-head card-header">
<h2 class="card-title">Data freshness</h2>
<div class="help-text">(Optional) A place to reflect daily updates. This is the hook for a cam.io-style pipeline.</div>
</div>
<div class="note" style="display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;">
<div>
      Organizer input lives on a separate page for clean data entry.
      <a class="link" href="organizer.html">Open organizer page</a>
</div>
<div style="display:flex; gap:8px; align-items:center;">
<button class="btn btn-sm" id="dailyLogExportBtn" type="button">Export daily log</button>
</div>
</div>
<div class="field" style="margin-top:10px;">
<label class="label" for="dailyLogImportText">Import daily log (paste JSON)</label>
<textarea class="input" id="dailyLogImportText" placeholder='Paste JSON array of entries (or {"dailyLog": [...]})' rows="5"></textarea>
<div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
<button class="btn btn-sm" id="dailyLogImportBtn" type="button">Import &amp; merge</button>
<div aria-live="polite" class="mini-s" id="dailyLogImportMsg"></div>
</div>
</div>
<div class="subgrid">
<div class="mini">
<div class="mini-k">Last update</div>
<div class="mini-v" id="wkLastUpdate">â€”</div>
<div class="mini-s" id="wkFreshNote">No daily log configured yet</div>
</div>
<div class="mini">
<div class="mini-k">Rolling 7-day attempts</div>
<div class="mini-v" id="wkRollingAttempts">â€”</div>
<div class="mini-s" id="wkRollingNote">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Plan status</div>
<div class="mini-v" id="wkFreshStatus">â€”</div>
<div class="mini-s">Based on whether your log supports the assumed rates/capacity</div>
</div>
<div class="mini">
<div class="mini-k">Rolling 7-day contact rate</div>
<div class="mini-v" id="wkRollingCR">â€”</div>
<div class="mini-s" id="wkRollingCRNote">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Rolling 7-day support rate</div>
<div class="mini-v" id="wkRollingSR">â€”</div>
<div class="mini-s" id="wkRollingSRNote">â€”</div>
</div>
<div class="mini">
<div class="mini-k">Rolling attempts per org hour</div>
<div class="mini-v" id="wkRollingAPH">â€”</div>
<div class="mini-s" id="wkRollingAPHNote">â€”</div>
</div>
</div>
<div class="note" style="display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin-top:10px;">
<span class="mini-s">Analyst tools:</span>
<button class="btn btn-sm" id="applyRollingCRBtn" type="button">Use rolling contact rate</button>
<button class="btn btn-sm" id="applyRollingSRBtn" type="button">Use rolling support rate</button>
<span aria-live="polite" class="mini-s" id="applyRollingMsg"></span>
</div>
<div class="note">Reality check uses your daily log to estimate actual rates/capacity over the last 7 entries.</div>
</div>
<div class="card card-section phase-phase2" id="conversionCard">
<div class="card-head card-header">
<h2 class="card-title">Persuasion &amp; contact math</h2>
<div class="help-text">Field math: Attempts â†’ Contacts (contact rate) â†’ Support IDs (support rate). Used across cost, optimization, and simulation.</div></div>
</div>
</section>
<!-- â”€â”€ STAGE: gotv â”€â”€ -->
<section class="stage-new" id="stage-gotv">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 5</span>
<span class="stage-title-new">GOTV / Turnout</span>
</div>
<p class="stage-sub-new">Model turnout lift as a lever. GOTV is often the cheapest late-stage tactic when persuasion saturates.</p>
<div class="training-panel-new" id="train-gotv">
<div class="training-hd-new" onclick="toggleTrainPanel('train-gotv')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” GOTV &amp; Turnout Lift</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>GOTV produces <em>additional votes</em>, not vote share changes. It increases the probability that a supporter actually casts a ballot. The lift is percentage points added to turnout probability per successful contact.</p>
<div class="training-rule-new">Baseline turnout:    % of target universe that votes without contact<br/>Lift per contact:    +1â€“4pp is realistic for strong GOTV<br/>Ceiling:             total lift can't push turnout above 100%<br/>Diminishing returns: each contact past the first yields less</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Key distinction</div>
<ul>
<li><strong>Persuasion:</strong> changes who they vote for (share shift)</li>
<li><strong>GOTV:</strong> changes whether they vote (turnout lift)</li>
<li><strong>Hybrid:</strong> persuasion realization weighted by turnout lift</li>
</ul>
<div class="training-caution-new">In many races, persuasion saturates quickly at the available universe size. GOTV can close a gap more cheaply in the final 3â€“4 weeks.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="grid3">
<div class="field">
<label class="label" for="goalSupportIds">Support IDs needed (goal)</label>
<input class="input num" id="goalSupportIds" min="0" placeholder="auto (uses persuasion need)" step="1" type="number"/>
<div class="help" data-help="If blank, goal = Persuasion votes needed (net) from Win path.">
<span class="help-title">Default</span>
<span class="help-text">This uses the modelâ€™s net persuasion votes needed as your support-ID goal.</span>
</div>
</div>
<div class="field">
<label class="label" for="supportRatePct">Support rate (of conversations)</label>
<input class="input num" id="supportRatePct" max="100" min="0" placeholder="e.g., 55" step="0.1" type="number"/>
<div class="help" data-help="Of completed conversations, % you will ID as your support (not persuasion win rate).">
<span class="help-title">Example</span>
<span class="help-text">If 55% of conversations yield a support ID, set 55.</span>
</div>
</div>
<div class="field">
<label class="label" for="contactRatePct">Contact rate (doors â†’ conversation)</label>
<input class="input num" id="contactRatePct" max="100" min="0" placeholder="e.g., 22" step="0.1" type="number"/>
<div class="help" data-help="Conversation rate: the percent of doors that become an actual live conversation.">
<span class="help-title">Typical</span>
<span class="help-text">15â€“30% depending on building type, time, and list quality.</span>
</div>
</div>
<div class="field">
<label class="label" for="doorsPerHour">Doors per hour</label>
<input class="input num" id="doorsPerHour" min="0" placeholder="e.g., 30" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="hoursPerShift">Hours per shift</label>
<input class="input num" id="hoursPerShift" min="0" placeholder="e.g., 3" step="0.5" type="number"/>
</div>
<div class="field">
<label class="label" for="shiftsPerVolunteerPerWeek">Shifts per volunteer / week</label>
<input class="input num" id="shiftsPerVolunteerPerWeek" min="0" placeholder="e.g., 2" step="0.5" type="number"/>
</div>
</div>
<div class="subgrid">
<div class="mini">
<div class="mini-k">Conversations needed</div>
<div class="mini-v" id="outConversationsNeeded">â€”</div>
<div class="mini-s">Goal Ã· Support rate</div>
</div>
<div class="mini">
<div class="mini-k">Doors needed</div>
<div class="mini-v" id="outDoorsNeeded">â€”</div>
<div class="mini-s">Conversations Ã· Contact rate</div>
</div>
<div class="mini">
<div class="mini-k">Doors per shift</div>
<div class="mini-v" id="outDoorsPerShift">â€”</div>
<div class="mini-s">Doors/hour Ã— Hours/shift</div>
</div>
</div>
</div><div class="card card-section phase16" id="universe16Card" style="padding:12px;">
<div class="card-head card-header" style="margin-bottom:8px;">
</div>
</div></section>
<!-- â”€â”€ STAGE: structure â”€â”€ -->
<section class="stage-new" id="stage-structure">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 6</span>
<span class="stage-title-new">Electorate structure</span>
</div>
<p class="stage-sub-new">Optional realism layer: weight persuasion and turnout by coalition mix and apply a support durability factor.</p>
<div class="training-panel-new" id="train-structure">
<div class="training-hd-new" onclick="toggleTrainPanel('train-structure')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Electorate Structure</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>This layer weights persuasion and turnout reliability by party composition (Dem/Rep/NPA/Other) and applies a single retention factor. It is aggregate-only â€” not a CRM or individual-level model.</p>
<div class="training-rule-new">Retention factor: % of IDs that hold through Election Day<br/>0.85 = 15% of your support IDs fade or were wrong<br/>0.70 = aggressive assumption for early contacts<br/>OFF = uses your raw persuasion rates directly</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">When to use it</div>
<ul>
<li>When you have reliable partisan registration data from your voter file</li>
<li>When there's a meaningful NPA block that behaves differently</li>
<li>When you want to stress-test support durability over a long field program</li>
</ul>
<div class="training-caution-new">Leave this OFF until you have voter file data. Guessing at party composition adds noise, not insight.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="card-head card-header" style="margin-bottom:8px;">
<h2 class="card-title">Electorate structure &amp; support durability</h2>
<div class="help-text">Optional realism layer: weight persuasion and turnout by coalition mix, and apply a support durability factor. OFF = baseline.</div></div>
<details>
<div class="note">Shares are auto-normalized to total 100% if slightly off.</div><summary class="muted" style="cursor:pointer;">Advanced (optional)</summary>
<div style="margin-top:10px;">
<div class="row" style="align-items:center; gap:10px; margin-bottom:10px;">
<label class="switch">
<input id="universe16Enabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable electorate weighting</span>
</label>
<div class="muted">OFF by default (no drift).</div>
</div>
<div class="grid4">
<div class="field">
<label class="label" for="universe16DemPct">Dem share (%)</label>
<input class="input num" id="universe16DemPct" max="100" min="0" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="universe16RepPct">Rep share (%)</label>
<input class="input num" id="universe16RepPct" max="100" min="0" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="universe16NpaPct">Unaffiliated share (%)</label>
<input class="input num" id="universe16NpaPct" max="100" min="0" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="universe16OtherPct">Other share (%)</label>
<input class="input num" id="universe16OtherPct" max="100" min="0" step="0.1" type="number"/>
</div>
</div>
<div class="grid2" style="margin-top:10px;">
<div class="field">
<label class="label" for="retentionFactor">Support retention (0.60â€“0.95)</label>
<input class="input num" id="retentionFactor" max="0.95" min="0.60" step="0.01" type="number"/>
<div class="help" data-help="Aggregate durability of support IDs through the rest of the race (voter-ID + reinforcement).">
<span class="help-title">Meaning</span>
<span class="help-text">Higher = support sticks + turns out more reliably. Lower = more soft decay + more fragility.</span>
</div>
</div>
<div class="field">
<label class="label">Derived (internal)</label>
<div class="muted" id="universe16Derived" style="padding:10px; border:1px solid var(--line); border-radius:10px;">â€”</div>
</div>
</div>
<div class="banner warn" hidden="" id="universe16Warn" style="margin-top:10px;"></div>
</div>
</details>
<div class="note">This layer weights persuasion and turnout reliability by party composition and applies a single retention factor. It is aggregate-only (not a CRM).</div>
</div></section>

<!-- â”€â”€ STAGE: results â”€â”€ -->
<section class="stage-new" id="stage-results">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 7</span>
<span class="stage-title-new">Results &amp; risk</span>
</div>
<p class="stage-sub-new">Win path, Monte Carlo stress test, sensitivity analysis, and risk framing. This is the payoff.</p>
<div class="training-panel-new" id="train-results">
<div class="training-hd-new" onclick="toggleTrainPanel('train-results')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Reading Results</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage shows</div>
<p>The win path answers one question: given your assumptions, how many votes do you need and which lever is cheapest to close the gap? Monte Carlo stress-tests that answer across thousands of simulations with uncertainty bands.</p>
<div class="training-rule-new">Win probability:  how often you win across simulations<br/>P10/P90:         your worst-case / best-case range<br/>Margin of safety: votes above threshold in median run<br/>Fragility:        how sensitive win prob is to small shifts</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">How to use it</div>
<ul>
<li>Win probability below 55% â†’ re-examine capacity or assumptions</li>
<li>Wide P10â€“P90 band â†’ high volatility, reduce uncertainty before committing resources</li>
<li>Sensitivity table tells you what to <em>measure first</em> in real life</li>
<li>Expected value can hide risk â€” use the stress test, not just the headline</li>
</ul>
<div class="training-caution-new">This tool defines operational requirements under stated assumptions. It does not predict outcomes.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<nav aria-label="Output tabs" class="tabs">
<button class="tab active" data-tab="win">Results</button>
<button class="tab" data-tab="assumptions">Checks</button>
<button class="tab" data-tab="roi">Plan</button>
</nav>
<section class="panel active" id="tab-win">
<div class="card card-section phase-p3" id="phase3Card">
<div class="mc-details">
<div class="mc-summary">
<span class="mc-summary-title">Execution &amp; uncertainty</span>
<span class="chip">Monte Carlo 10k</span>
</div>
<div class="mc-body">
<div class="grid3">
<div class="field">
<label class="label" for="orgCount">Organizers (count)</label>
<input class="input num" id="orgCount" min="0" placeholder="e.g., 2" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="orgHoursPerWeek">Organizer hours / week</label>
<input class="input num" id="orgHoursPerWeek" min="0" placeholder="e.g., 40" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="volunteerMultBase">Volunteer multiplier (base)</label>
<input class="input num" id="volunteerMultBase" min="0" placeholder="e.g., 1.00" step="0.05" type="number"/>
<div class="help" data-help="Applies to total output. 1.20 = +20% more contact capacity from volunteers and shared shifts.">
<span class="help-title">How to use</span>
<span class="help-text">Set to 1.00 if you want a staff-only plan. Increase as your volunteer program stabilizes.</span>
</div>
</div>
<div class="field">
<label class="label" for="channelDoorPct">Door share % (vs calls)</label>
<input class="input num" id="channelDoorPct" max="100" min="0" placeholder="e.g., 70" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="doorsPerHour3">Doors per hour (base)</label>
<input class="input num" id="doorsPerHour3" min="0" placeholder="e.g., 30" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="callsPerHour3">Calls per hour (base)</label>
<input class="input num" id="callsPerHour3" min="0" placeholder="e.g., 20" step="1" type="number"/>
</div>
</div>
<div class="subgrid">
<div class="mini">
<div class="mini-k">Weeks remaining</div>
<div class="mini-v" id="p3Weeks">â€”</div>
<div class="mini-s">Uses election date or manual override</div>
</div>
<div class="mini">
<div class="mini-k">Capacity: contacts possible</div>
<div class="mini-v" id="p3CapContacts">â€”</div>
<div class="mini-s">Ceiling from staff Ã— time Ã— productivity Ã— volunteer multiplier</div>
</div>
<div class="mini">
<div class="mini-k">Gap vs required contacts</div>
<div class="mini-v" id="p3GapContacts">â€”</div>
<div class="mini-s" id="p3GapNote">â€”</div>
</div>
</div>
<div class="mc-row">
<div class="mc-actions">
<div class="field" style="min-width:220px;">
<label class="label" for="mcMode">Monte Carlo mode</label>
<select class="select" id="mcMode">
<option selected="" value="basic">Basic (volatility slider)</option>
<option value="advanced">Advanced (min / mode / max)</option>
</select>
</div>
<div class="field" style="min-width:220px;">
<label class="label" for="mcSeed">Seed (optional)</label>
<input class="input input-sm" id="mcSeed" placeholder="leave blank for random" type="text"/>
</div>
<button class="btn btn-sm" id="mcRun" type="button">Run 10,000 sims</button>
<button class="btn btn-sm" id="mcRerun" type="button">Re-run MC</button>
<span class="tag" id="mcFreshTag">Not run</span>
<span class="muted" id="mcLastRun">Last run: â€”</span>
<span class="mc-pill mc-stale warn" hidden="" id="mcStale">Results are stale</span>
</div>
</div>
<div class="mc-basic" id="mcBasic">
<div class="grid3">
<div class="field">
<label class="label" for="mcVolatility">Volatility</label>
<select class="select" id="mcVolatility">
<option value="low">Low</option>
<option selected="" value="med">Medium</option>
<option value="high">High</option>
</select>
<div class="help" data-help="Volatility generates min/mode/max around your base rates. Medium is a strong default.">
<span class="help-title">Best practice</span>
<span class="help-text">Use Medium unless you have strong evidence of stability (Low) or chaos (High).</span>
</div>
</div>
<div class="field">
<label class="label" for="turnoutReliabilityPct">Turnout reliability % (base)</label>
<input class="input num" id="turnoutReliabilityPct" max="100" min="0" placeholder="e.g., 80" step="0.5" type="number"/>
<div class="help" data-help="Percent of newly persuaded supporters who will actually cast a ballot.">
<span class="help-title">What this is</span>
<span class="help-text">This is not overall turnout %. It is your modeled reliability for your moved vote.</span>
</div>
</div>
<div class="field">
<label class="label" for="mcRuns">Runs</label>
<input class="input num" disabled="" id="mcRuns" min="1000" step="1000" type="number" value="10000"/>
</div>
</div>
<div class="note">
                  Basic mode uses your base contact and support rates, plus the reliability and capacity assumptions above.
                </div>
</div>
<div class="mc-adv" id="mcAdvanced">
<div class="note">Advanced mode uses triangular distributions (min / expected / max) per variable.</div>
<div class="table-wrap">
<table aria-label="Monte Carlo ranges" class="table sens-table">
<thead>
<tr>
<th>Variable</th>
<th class="num">Min</th>
<th class="num">Expected</th>
<th class="num">Max</th>
</tr>
</thead>
<tbody>
<tr>
<td>Contact rate % (contacts â†’ conversations)</td>
<td class="num"><input class="input input-sm num" id="mcContactMin" max="100" min="0" step="0.1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcContactMode" max="100" min="0" step="0.1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcContactMax" max="100" min="0" step="0.1" type="number"/></td>
</tr>
<tr>
<td>Persuasion rate % (conversations â†’ support ID)</td>
<td class="num"><input class="input input-sm num" id="mcPersMin" max="100" min="0" step="0.1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcPersMode" max="100" min="0" step="0.1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcPersMax" max="100" min="0" step="0.1" type="number"/></td>
</tr>
<tr>
<td>Turnout reliability % (support ID â†’ vote)</td>
<td class="num"><input class="input input-sm num" id="mcReliMin" max="100" min="0" step="0.5" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcReliMode" max="100" min="0" step="0.5" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcReliMax" max="100" min="0" step="0.5" type="number"/></td>
</tr>
<tr>
<td>Doors per hour</td>
<td class="num"><input class="input input-sm num" id="mcDphMin" min="0" step="1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcDphMode" min="0" step="1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcDphMax" min="0" step="1" type="number"/></td>
</tr>
<tr>
<td>Calls per hour</td>
<td class="num"><input class="input input-sm num" id="mcCphMin" min="0" step="1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcCphMode" min="0" step="1" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcCphMax" min="0" step="1" type="number"/></td>
</tr>
<tr>
<td>Volunteer multiplier</td>
<td class="num"><input class="input input-sm num" id="mcVolMin" min="0" step="0.05" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcVolMode" min="0" step="0.05" type="number"/></td>
<td class="num"><input class="input input-sm num" id="mcVolMax" min="0" step="0.05" type="number"/></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="kpis">
<div class="kpi">
<div class="kpi-k">Win probability</div>
<div class="kpi-v" id="mcWinProb">â€”</div>
<div class="kpi-s" id="mcRiskLabel">Run sims to estimate risk band.</div>
</div>
<div class="kpi">
<div class="kpi-k">Median net votes vs need</div>
<div class="kpi-v" id="mcMedian">â€”</div>
<div class="kpi-s">Net persuasion votes delivered âˆ’ persuasion votes needed</div>
</div>
<div class="kpi">
<div class="kpi-k">95th percentile (upside)</div>
<div class="kpi-v" id="mcP95">â€”</div>
<div class="kpi-s">Good-but-plausible environment</div>
</div>
<div class="kpi">
<div class="kpi-k">5th percentile (downside)</div>
<div class="kpi-v" id="mcP5">â€”</div>
<div class="kpi-s">Bad-but-plausible environment</div>
</div>
</div>
<div class="card card-readonly" style="padding:12px; margin-top:12px;">
<div class="card-head card-header" style="margin-bottom:8px;">
<h2 class="card-title">Confidence envelope</h2>
<div class="help-text">Uncertainty ranges from Monte Carlo runs (P10/P50/P90). Helps distinguish tight wins from fragile wins.</div></div>
<div class="table-wrap">
<table aria-label="Confidence envelope" class="table">
<tbody>
<tr><td>P10 / P50 / P90 margin</td><td class="num"><span id="mcP10">â€”</span> / <span id="mcP50">â€”</span> / <span id="mcP90">â€”</span></td></tr>
<tr><td>Attempts/week needed (P10 / P50 / P90)</td><td class="num"><span id="opsAttP10">â€”</span> / <span id="opsAttP50">â€”</span> / <span id="opsAttP90">â€”</span></td></tr>
<tr><td>Convos/week needed (P10 / P50 / P90)</td><td class="num"><span id="opsConP10">â€”</span> / <span id="opsConP50">â€”</span> / <span id="opsConP90">â€”</span></td></tr>
<tr><td>Finish date (P10 / P50 / P90)</td><td class="num"><span id="opsFinishP10">â€”</span> / <span id="opsFinishP50">â€”</span> / <span id="opsFinishP90">â€”</span></td></tr>
<tr><td>Risk of missing goal at current pace</td><td class="num"><span id="opsMissProb">â€”</span> <span class="tag ok" id="opsMissTag">â€”</span></td></tr>
<tr><td>Margin of safety (P10)</td><td class="num" id="mcMoS">â€”</td></tr>
<tr><td>Downside loss probability</td><td class="num" id="mcDownside">â€”</td></tr>
<tr><td>Expected shortfall (worst 10%)</td><td class="num" id="mcES10">â€”</td></tr>
<tr><td>Shift needed (make P50 â‰¥ 0)</td><td class="num" id="mcShiftP50">â€”</td></tr>
<tr><td>Shift needed (make P10 â‰¥ 0)</td><td class="num" id="mcShiftP10">â€”</td></tr>
<tr><td>Fragility index</td><td class="num" id="mcFragility">â€”</td></tr>
<tr><td>Cliff risk (near break-even)</td><td class="num" id="mcCliff">â€”</td></tr>
<tr><td>Risk grade</td><td class="num" id="mcRiskGrade">â€”</td></tr>
<tr><td>Shift needed (P(win) â‰¥ 60%)</td><td class="num" id="mcShift60">â€”</td></tr>
<tr><td>Shift needed (P(win) â‰¥ 70%)</td><td class="num" id="mcShift70">â€”</td></tr>
<tr><td>Shift needed (P(win) â‰¥ 80%)</td><td class="num" id="mcShift80">â€”</td></tr>
<tr><td>Win prob loss under -10 shock</td><td class="num" id="mcShock10">â€”</td></tr>
<tr><td>Win prob loss under -25 shock</td><td class="num" id="mcShock25">â€”</td></tr>
<tr><td>Win prob loss under -50 shock</td><td class="num" id="mcShock50">â€”</td></tr>
</tbody>
</table>
</div>
<div class="note">Margin is net persuasion votes delivered minus net persuasion votes needed. Fragility rises when small negative shocks materially reduce win probability.</div>
</div>
<div class="card card-readonly" style="padding:12px;">
<div class="card-head card-header" style="margin-bottom:8px;">
<h2 class="card-title">Sensitivity analysis (what matters most)</h2>
</div>
<div class="table-wrap">
<table aria-label="Sensitivity ranking" class="table">
<thead>
<tr>
<th>Variable</th>
<th class="num">Impact</th>
</tr>
</thead>
<tbody id="mcSensitivity">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="note">Impact uses correlation strength with margin across simulations (higher = more important).</div>
</div>
<div class="card card-panel" id="surfaceCard">
<div class="card-head card-header" style="margin-bottom:8px;">
<h2 class="card-title">Sensitivity analysis (surface)</h2>
</div>
<div class="grid2">
<div class="field">
<label class="label" for="surfaceLever">Lever</label>
<select class="select" id="surfaceLever">
<option value="volunteerMultiplier">Volunteer multiplier</option>
<option value="supportRate">Support rate (%)</option>
<option value="contactRate">Contact rate (%)</option>
<option value="turnoutReliability">Turnout reliability (%)</option>
</select>
</div>
<div class="field">
<label class="label" for="surfaceMode">Run mode</label>
<select class="select" id="surfaceMode">
<option value="fast">Fast (2k runs)</option>
<option value="full">Full (10k runs)</option>
</select>
</div>
<div class="field">
<label class="label" for="surfaceMin">Min</label>
<input class="input num" id="surfaceMin" step="0.01" type="number"/>
</div>
<div class="field">
<label class="label" for="surfaceMax">Max</label>
<input class="input num" id="surfaceMax" step="0.01" type="number"/>
</div>
<div class="field">
<label class="label" for="surfaceSteps">Points</label>
<input class="input num" id="surfaceSteps" max="51" min="5" step="1" type="number" value="21"/>
</div>
<div class="field">
<label class="label" for="surfaceTarget">Target win %</label>
<input class="input num" id="surfaceTarget" max="99" min="50" step="1" type="number" value="70"/>
</div>
</div>
<div class="row" style="margin-top:10px; align-items:center; gap:10px;">
<button class="btn" id="btnComputeSurface">Compute Surface</button>
<div aria-live="polite" class="muted" id="surfaceStatus"></div>
</div>
<div class="table-wrap" style="margin-top:10px;">
<table aria-label="Sensitivity surface results" class="table">
<thead>
<tr>
<th>Lever</th>
<th class="num">Win%</th>
<th class="num">P10</th>
<th class="num">P50</th>
<th class="num">P90</th>
</tr>
</thead>
<tbody id="surfaceTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="note" id="surfaceSummary">Compute to see safe zones, cliffs, and diminishing returns.</div>
</div>
</div>
</div>
</div>
<div class="card card-section" hidden="" id="explainCard">
<div class="card-head card-header">
<h2 class="card-title">Whatâ€™s driving the result</h2>
</div>
<div class="explain">
<details open="">
<summary>What this model is doing</summary></details></div>
<div class="explain-body">
<p>This tool defines operational requirements under stated assumptions. It does not predict outcomes.</p>
<ul>
<li>Turnout votes = Universe Ã— turnout %</li>
<li>Projected votes per candidate = Turnout votes Ã— support %</li>
<li>Undecided votes are allocated by your chosen rule</li>
<li>Win threshold = top competitor (after allocation) + 1</li>
<li>Persuasion votes needed = win threshold âˆ’ your projected votes</li>
</ul>
</div>
</div>
</section>
<section class="panel" id="tab-assumptions">
</section></div>
</section>
<!-- â”€â”€ STAGE: roi â”€â”€ -->
<section class="stage-new" id="stage-roi">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 8</span>
<span class="stage-title-new">Budget &amp; ROI</span>
</div>
<p class="stage-sub-new">Turn tactics into dollars and net votes. Find the cheapest path to closing the gap.</p>
<div class="training-panel-new" id="train-roi">
<div class="training-hd-new" onclick="toggleTrainPanel('train-roi')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Budget &amp; ROI</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage models</div>
<p>A plan without cost is a wish. This stage converts tactics to cost per net vote and net votes per dollar, then the optimizer finds the best mix under budget and capacity constraints.</p>
<div class="training-rule-new">Cost per net vote = CPA Ã· (CR Ã— persuasion rate)<br/>Doors: $8â€“25/net vote (high CR, slow scale)<br/>Phones: $4â€“14/net vote (lower CR, fast scale)<br/>Texts: $1â€“5/net vote (very low CR, very high scale)</div>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">Common mistakes</div>
<ul>
<li>"Pet tactic bias" â€” assuming doors are always best without checking cost</li>
<li>Ignoring capacity ceilings â€” you can't knock 50,000 doors with 1 organizer</li>
<li>Forgetting overhead â€” staff cost is real cost per vote</li>
</ul>
<div class="training-caution-new">The optimizer makes tradeoffs explicit that humans make poorly under multiple constraints.</div>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
<div class="card card-section phase-roi">
<div class="card-head card-header">
<h2 class="card-title">Cost inputs</h2>
</div>
<div class="grid3">
<div class="field">
<label class="label">Doors</label>
<div class="rowline">
<label class="switch">
<input id="roiDoorsEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
<span class="muted" style="font-size:12px;">Cost / attempt ($)</span>
</div>
<input class="input num" id="roiDoorsCpa" min="0" placeholder="e.g., 0.18" step="0.01" type="number"/>
<div class="field" style="margin-top:8px;">
<label class="label" for="roiDoorsKind">Tactic type</label>
<select class="select input-sm" id="roiDoorsKind">
<option selected="" value="persuasion">Persuasion</option>
<option value="gotv">GOTV</option>
<option value="hybrid">Hybrid</option>
</select>
<div class="help" data-help="Persuasion affects preference; GOTV affects turnout probability; Hybrid applies turnout lift to persuasion realization.">
<span class="help-title">Why this matters</span>
<span class="help-text">Optimization can target Net Votes or Turnout-adjusted Net Votes (when turnout modeling is enabled).</span>
</div>
</div>
<div class="grid2" style="margin-top:8px;">
<div class="field">
<label class="label" for="roiDoorsCr">Contact rate override %</label>
<input class="input input-sm num" id="roiDoorsCr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="roiDoorsSr">Support rate override %</label>
<input class="input input-sm num" id="roiDoorsSr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
</div>
<div class="note">Attempt = door knocked. Uses your contact/support rates and turnout reliability.</div>
</div>
<div class="field">
<label class="label">Phones</label>
<div class="rowline">
<label class="switch">
<input id="roiPhonesEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
<span class="muted" style="font-size:12px;">Cost / attempt ($)</span>
</div>
<input class="input num" id="roiPhonesCpa" min="0" placeholder="e.g., 0.03" step="0.01" type="number"/>
<div class="field" style="margin-top:8px;">
<label class="label" for="roiPhonesKind">Tactic type</label>
<select class="select input-sm" id="roiPhonesKind">
<option selected="" value="persuasion">Persuasion</option>
<option value="gotv">GOTV</option>
<option value="hybrid">Hybrid</option>
</select>
<div class="help" data-help="Persuasion affects preference; GOTV affects turnout probability; Hybrid applies turnout lift to persuasion realization.">
<span class="help-title">Why this matters</span>
<span class="help-text">Optimization can target Net Votes or Turnout-adjusted Net Votes (when turnout modeling is enabled).</span>
</div>
</div>
<div class="grid2" style="margin-top:8px;">
<div class="field">
<label class="label" for="roiPhonesCr">Contact rate override %</label>
<input class="input input-sm num" id="roiPhonesCr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="roiPhonesSr">Support rate override %</label>
<input class="input input-sm num" id="roiPhonesSr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
</div>
<div class="note">Attempt = call dialed. Uses the same contact/support backbone.</div>
</div>
<div class="field">
<label class="label">Texts</label>
<div class="rowline">
<label class="switch">
<input id="roiTextsEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
<span class="muted" style="font-size:12px;">Cost / attempt ($)</span>
</div>
<input class="input num" id="roiTextsCpa" min="0" placeholder="e.g., 0.02" step="0.01" type="number"/>
<div class="field" style="margin-top:8px;">
<label class="label" for="roiTextsKind">Tactic type</label>
<select class="select input-sm" id="roiTextsKind">
<option selected="" value="persuasion">Persuasion</option>
<option value="gotv">GOTV</option>
<option value="hybrid">Hybrid</option>
</select>
<div class="help" data-help="Persuasion affects preference; GOTV affects turnout probability; Hybrid applies turnout lift to persuasion realization.">
<span class="help-title">Why this matters</span>
<span class="help-text">Optimization can target Net Votes or Turnout-adjusted Net Votes (when turnout modeling is enabled).</span>
</div>
</div>
<div class="grid2" style="margin-top:8px;">
<div class="field">
<label class="label" for="roiTextsCr">Contact rate override %</label>
<input class="input input-sm num" id="roiTextsCr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="roiTextsSr">Support rate override %</label>
<input class="input input-sm num" id="roiTextsSr" max="100" min="0" placeholder="auto (from contact math)" step="0.1" type="number"/>
</div>
</div>
<div class="note">Attempt = text sent. Uses the same contact/support backbone.</div>
</div>
</div>
<div class="divider-h"></div>
<div class="grid2">
<div class="field">
<label class="label">Overhead (optional)</label>
<input class="input num" id="roiOverheadAmount" min="0" placeholder="e.g., 2500" step="1" type="number"/>
<div class="note">Overhead is separate from per-attempt costs. You can include it in ROI as an allocation.</div>
</div>
<div class="field">
<label class="label">Include overhead in ROI</label>
<label class="switch" style="margin-top:6px;">
<input id="roiIncludeOverhead" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Allocate overhead across required attempts</span>
</label>
<div class="note">If on: overhead is spread across required attempts for each tactic (deterministic).</div>
</div>
</div>
</div>
<div class="card card-section phase-roi">
<div class="card-head card-header">
<h2 class="card-title">ROI comparison</h2>
<div class="card-actions">
<button class="btn btn-link" id="roiRefresh" type="button">Refresh</button>
</div>
</div>
<div class="table-wrap">
<table aria-label="ROI table" class="table">
<thead>
<tr>
<th>Tactic</th>
<th class="num">Cost / attempt</th>
<th class="num">Cost / net vote</th>
<th class="num">Cost / TA net vote</th>
<th class="num">Total cost to close gap</th>
<th>Feasibility</th>
</tr>
</thead>
<tbody id="roiTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="banner warn" hidden="" id="roiBanner"></div>
<div class="note">
            ROI backbone: Attempts â†’ Contacts (CR) â†’ Support IDs (SR) â†’ Net votes (turnout-adjusted). Costs are deterministic.
          </div>
</div>
<div class="card card-section phase-p6">
<div class="card-head card-header">
<h2 class="card-title">Turnout &amp; GOTV</h2>
</div>
<div class="rowline" style="margin-bottom:10px;">
<label class="switch">
<input id="turnoutEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable turnout modeling</span>
</label>
<span class="muted" style="font-size:12px;">OFF keeps outputs identical.</span>
</div>
<div class="grid3">
<div class="field">
<label class="label" for="turnoutBaselinePct">Baseline turnout rate %</label>
<input class="input num" id="turnoutBaselinePct" max="100" min="0" placeholder="e.g., 55" step="0.5" type="number"/>
<div class="help" data-help="Baseline probability of voting for the GOTV target universe (not overall electorate turnout).">
<span class="help-title">What this is</span>
<span class="help-text">Used only when turnout modeling is enabled, to cap lift at 100% and keep the math defensible.</span>
</div>
</div>
<div class="field">
<label class="label" for="turnoutTargetOverridePct">Target universe turnout override % (optional)</label>
<input class="input num" id="turnoutTargetOverridePct" max="100" min="0" placeholder="blank = use baseline" step="0.5" type="number"/>
<div class="help" data-help="If your GOTV target universe turns out at a different rate than your baseline, set it here.">
<span class="help-title">When to use</span>
<span class="help-text">Example: low-propensity base universe (override lower) or high-propensity supporters (override higher).</span>
</div>
</div>
<div class="field">
<label class="label" for="gotvMode">GOTV lift model</label>
<select class="select" id="gotvMode">
<option selected="" value="basic">Basic (single lift)</option>
<option value="advanced">Advanced (min/mode/max)</option>
</select>
<div class="help" data-help="Advanced mode is sampled per Monte Carlo run to model uncertainty.">
<span class="help-title">Monte Carlo</span>
<span class="help-text">Use Advanced when lift is uncertain. Seeded reproducibility is preserved.</span>
</div>
</div>
</div>
<div class="mc-subpanel active" id="gotvBasic" style="margin-top:10px;">
<div class="grid3">
<div class="field">
<label class="label" for="gotvLiftPP">GOTV lift per contact (pp)</label>
<input class="input num" id="gotvLiftPP" max="25" min="0" placeholder="e.g., 1.0" step="0.1" type="number"/>
<div class="help" data-help="Lift is percentage points added to turnout probability per successful contact.">
<span class="help-title">Example</span>
<span class="help-text">1.0 means +1pp turnout probability for a contacted voter, before saturation caps apply.</span>
</div>
</div>
<div class="field">
<label class="label" for="gotvMaxLiftPP">Max lift ceiling (pp)</label>
<input class="input num" id="gotvMaxLiftPP" max="50" min="0" placeholder="e.g., 10" step="0.5" type="number"/>
<div class="help" data-help="Ceiling on total turnout lift above baseline for the target universe (kept &lt;= 100%).">
<span class="help-title">Why it exists</span>
<span class="help-text">Prevents unrealistic implied turnout like 120%.</span>
</div>
</div>
<div class="field">
<label class="label">Diminishing returns</label>
<div class="rowline">
<label class="switch">
<input id="gotvDiminishing" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
</div>
<div class="note">OFF by default. When ON, marginal lift tapers as you approach the ceiling.</div>
</div>
</div>
</div>
<div class="mc-subpanel" id="gotvAdvanced" style="margin-top:10px;">
<div class="grid3">
<div class="field">
<label class="label" for="gotvLiftMin">Lift min (pp)</label>
<input class="input num" id="gotvLiftMin" max="25" min="0" placeholder="e.g., 0.5" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="gotvLiftMode">Lift mode (pp)</label>
<input class="input num" id="gotvLiftMode" max="25" min="0" placeholder="e.g., 1.0" step="0.1" type="number"/>
</div>
<div class="field">
<label class="label" for="gotvLiftMax">Lift max (pp)</label>
<input class="input num" id="gotvLiftMax" max="25" min="0" placeholder="e.g., 2.0" step="0.1" type="number"/>
</div>
</div>
<div class="grid3" style="margin-top:10px;">
<div class="field">
<label class="label" for="gotvMaxLiftPP2">Max lift ceiling (pp)</label>
<input class="input num" id="gotvMaxLiftPP2" max="50" min="0" placeholder="e.g., 10" step="0.5" type="number"/>
</div>
<div class="field">
<label class="label">Diminishing returns</label>
<div class="rowline">
<label class="switch">
<input id="gotvDiminishing2" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
</div>
</div>
<div class="field">
<label class="label">Status</label>
<div class="note">Advanced lift is sampled per Monte Carlo run. Deterministic uses Mode.</div>
</div>
</div>
</div>
<div class="note" style="margin-top:10px;">
    Turnout modeling affects <b>realized votes</b>. Persuasion changes preference among those who vote. GOTV increases the probability of voting in the target universe.
  </div>
<div class="banner ok" hidden="" id="turnoutSummary"></div>
</div>
<div class="card card-section phase-p5">
<div class="card-head card-header">
<h2 class="card-title">Plan optimization</h2>
<div class="card-actions">
<button class="btn btn-link" id="optRun" type="button">Optimize</button>
</div>
</div>
<div class="help-text">Allocates attempts across tactics given budget, capacity, and (optional) timeline caps.</div>
<div class="grid3">
<div class="field">
<label class="label" for="optMode">Mode</label>
<select class="select" id="optMode">
<option selected="" value="budget">Budget-constrained</option>
<option value="capacity">Capacity-constrained</option>
</select>
<div class="note">Optimization sits on top of ROI rates (including any CR/SR overrides) and deterministic cost-per-attempt.</div>
</div>
<div class="field">
<label class="label" for="optObjective">Optimize for</label>
<select class="select" id="optObjective">
<option selected="" value="net">Net Votes</option>
<option value="turnout">Turnout-Adjusted Net Votes</option>
</select>
<div class="note">Default objective is Net Votes. Turnout-adjusted objective uses turnout modeling when enabled.</div>
</div>
<div class="field">
<label class="label">Timeline-Constrained Optimization</label>
<label class="switch">
<input id="tlOptEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable</span>
</label>
<div class="note">Adds timeline production caps  as hard limits per tactic. OFF preserves standard optimizer exactly.</div>
</div>
<div class="field">
<label class="label" for="tlOptObjective">Timeline objective</label>
<select class="select" id="tlOptObjective">
<option selected="" value="max_net">Maximize net votes by deadline</option>
<option value="min_cost_goal">Minimize cost while meeting goal (if feasible)</option>
</select>
<div class="note">When goal is impossible under caps, returns the best feasible plan and flags goalFeasible=false.</div>
</div>
<div class="field">
<label class="label" for="optBudget">Budget ($)</label>
<input class="input num" id="optBudget" min="0" placeholder="e.g., 25000" step="1" type="number"/>
<div class="note">If overhead allocation is ON, overhead is treated as fixed in budget mode (non-circular).</div>
</div>
<div class="field" hidden="">
<label class="label" for="optCapacity">Attempt ceiling</label>
<input class="input num" id="optCapacity" min="0" placeholder="auto (from capacity ceiling)" step="1" type="number"/>
<div class="note">If blank, uses the capacity ceiling estimate (attempts possible).</div>
</div>
</div>
<div class="grid3" style="margin-top:10px;">
<div class="field">
<label class="label" for="optStep">Step size (attempts)</label>
<input class="input num" id="optStep" min="1" step="1" type="number" value="25"/>
<div class="note">Allocates in steps for stability (smaller = finer, slower).</div>
</div>
<div class="field">
<label class="label">Optional realism</label>
<label class="switch" style="margin-top:6px;">
<input id="optUseDecay" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Diminishing returns (off by default)</span>
</label>
<div class="note">Off by default to preserve baseline outputs.</div>
</div>
<div class="field">
<label class="label">Binding constraint</label>
<div class="metric">
<div class="metric-k">What stopped allocation</div>
<div class="metric-v" id="optBinding">â€”</div>
</div>
</div>
</div>
<div class="divider-h"></div>
<div class="kpis">
<div class="kpi">
<div class="kpi-k">Total attempts</div>
<div class="kpi-v" id="optTotalAttempts">â€”</div>
<div class="kpi-s">Sum across enabled tactics</div>
</div>
<div class="kpi">
<div class="kpi-k">Total cost</div>
<div class="kpi-v" id="optTotalCost">â€”</div>
<div class="kpi-s">Includes fixed overhead in budget mode (if enabled)</div>
</div>
<div class="kpi">
<div class="kpi-k">Expected net persuasion votes</div>
<div class="kpi-v" id="optTotalVotes">â€”</div>
<div class="kpi-s">Deterministic: Attempts Ã— (CR Ã— SR Ã— TR)</div>
</div>
<div class="kpi">
<div class="kpi-k">Gap context</div>
<div class="kpi-v" id="optGapContext">â€”</div>
<div class="kpi-s">Persuasion need (Expected) for reference</div>
</div>
</div>
<div class="banner warn" hidden="" id="optBanner"></div>
<div class="card card-panel mini" hidden="" id="tlOptResults" style="margin-top:10px;">
<div class="card-head card-header">
<h3 style="margin:0;">Timeline-Constrained Results</h3>
</div>
<div class="kpis" style="margin-top:8px;">
<div class="kpi">
<div class="kpi-k">goalFeasible</div>
<div class="kpi-v" id="tlOptGoalFeasible">â€”</div>
<div class="kpi-s">True if goal can be met under caps</div>
</div>
<div class="kpi">
<div class="kpi-k">maxAchievableNetVotes</div>
<div class="kpi-v" id="tlOptMaxNetVotes">â€”</div>
<div class="kpi-s">Best possible under constraints</div>
</div>
<div class="kpi">
<div class="kpi-k">remainingGapNetVotes</div>
<div class="kpi-v" id="tlOptRemainingGap">â€”</div>
<div class="kpi-s">0 if goalFeasible=true</div>
</div>
<div class="kpi">
<div class="kpi-k">bindingConstraints</div>
<div class="kpi-v" id="tlOptBinding">â€”</div>
<div class="kpi-s">Timeline / budget / capacity</div>
</div>
</div>
<div class="divider-h" style="margin:10px 0;"></div>
<div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
<div class="muted" style="font-weight:700;">Bottlenecks &amp; Marginal Value</div>
</div>
<div class="rowline" style="margin-top:8px;justify-content:flex-start;">
<label class="switch">
<input id="toggleAdvDiag" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Advanced diagnostics</span>
</label>
</div>
<div class="card card-panel card-readonly dev-panel" hidden="" id="advDiagBox" style="margin-top:10px;">
<div class="card-head card-header">
<h2 class="card-title">Snapshot integrity</h2>
</div>
<div class="grid2">
<div class="field">
<label class="label">Snapshot hash (read-only)</label>
<div class="mono" id="snapshotHash">â€”</div>
<div class="note">Deterministic hash of the exported snapshot. Changes whenever inputs/toggles/objective/seed/timeline change.</div>
</div>
</div>
</div>
<div class="kpis" style="margin-top:8px;">
<div class="kpi">
<div class="kpi-k">primaryBottleneck</div>
<div class="kpi-v" id="tlMvPrimary">â€”</div>
<div class="kpi-s">Which constraint is binding</div>
</div>
<div class="kpi">
<div class="kpi-k">secondaryNotes</div>
<div class="kpi-v" id="tlMvSecondary">â€”</div>
<div class="kpi-s">Near-binding hints (optional)</div>
</div>
</div>
<div class="table-wrap" style="margin-top:8px;">
<table aria-label="Marginal value interventions" class="table">
<thead>
<tr>
<th>Intervention</th>
<th class="num">Î” max net votes</th>
<th class="num">Î” cost</th>
<th>Notes</th>
</tr>
</thead>
<tbody id="tlMvTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="muted">â€”</td></tr>
</tbody>
</table>
</div>
</div>
<div class="table-wrap sc-table">
<table aria-label="Optimization allocation table" class="table">
<thead>
<tr>
<th>Tactic</th>
<th class="num">Attempts</th>
<th class="num">Cost</th>
<th class="num">Expected net votes</th>
</tr>
</thead>
<tbody id="optTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="note">
    Interpretation: If diminishing returns is OFF and there are no caps, the optimal allocation can legitimately concentrate in the single best marginal tactic.
  </div>
</div>
<div class="card card-section card-section--timeline phase-p7">
<div class="card-head card-header">
<h2 class="card-title">Field capacity &amp; timeline</h2>
</div>
<div class="rowline" style="margin-bottom:10px;">
<label class="switch">
<input id="timelineEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable timeline feasibility check</span>
</label>
<span class="muted" style="font-size:12px;">OFF does not change any baseline outputs.</span>
</div>
<div class="grid3">
<div class="field">
<label class="label" for="timelineWeeksAuto">Weeks remaining (auto)</label>
<input class="input num" disabled="" id="timelineWeeksAuto" type="number"/>
<div class="note">Derived from Election Date (or manual Weeks Remaining override).</div>
</div>
<div class="field">
<label class="label" for="timelineActiveWeeks">Active production weeks (optional override)</label>
<input class="input num" id="timelineActiveWeeks" min="0" placeholder="blank = use weeks remaining" step="1" type="number"/>
<div class="note">Use when you lose weeks to onboarding, ballot access, holidays, etc.</div>
</div>
<div class="field">
<label class="label" for="timelineGotvWeeks">GOTV window length (weeks)</label>
<input class="input num" id="timelineGotvWeeks" min="0" placeholder="e.g., 2" step="1" type="number"/>
<div class="note">Applied to tactics marked as turnout (if any).</div>
</div>
</div>
<div class="divider-h"></div>
<div class="grid3">
<div class="field">
<label class="label" for="timelineStaffCount">Paid field staff (#)</label>
<input class="input num" id="timelineStaffCount" min="0" placeholder="e.g., 2" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="timelineStaffHours">Avg staff hours / week</label>
<input class="input num" id="timelineStaffHours" min="0" placeholder="e.g., 40" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="timelineVolCount">Active volunteers / week (#)</label>
<input class="input num" id="timelineVolCount" min="0" placeholder="e.g., 10" step="1" type="number"/>
</div>
</div>
<div class="grid3" style="margin-top:10px;">
<div class="field">
<label class="label" for="timelineVolHours">Avg volunteer hours / week</label>
<input class="input num" id="timelineVolHours" min="0" placeholder="e.g., 4" step="1" type="number"/>
<div class="note">Total weekly hours = staffÃ—hours + volunteersÃ—hours.</div>
</div>
<div class="field">
<label class="label">Ramp-up (optional)</label>
<label class="switch" style="margin-top:6px;">
<input id="timelineRampEnabled" type="checkbox"/>
<span class="slider"></span>
<span class="switch-label">Enable ramp-up distribution</span>
</label>
<div class="note">OFF by default. Does not change feasibility math; affects weekly preview only.</div>
</div>
<div class="field">
<label class="label" for="timelineRampMode">Ramp shape</label>
<select class="select" id="timelineRampMode">
<option selected="" value="linear">Linear</option>
<option value="s">S-curve</option>
</select>
<div class="note">Preview-only. Keeps totals consistent.</div>
</div>
</div>
<div class="divider-h"></div>
<div class="grid3">
<div class="field">
<label class="label" for="timelineDoorsPerHour">Doors attempts / hour</label>
<input class="input num" id="timelineDoorsPerHour" min="0" placeholder="e.g., 30" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="timelineCallsPerHour">Calls attempts / hour</label>
<input class="input num" id="timelineCallsPerHour" min="0" placeholder="e.g., 20" step="1" type="number"/>
</div>
<div class="field">
<label class="label" for="timelineTextsPerHour">Texts attempts / hour</label>
<input class="input num" id="timelineTextsPerHour" min="0" placeholder="e.g., 120" step="1" type="number"/>
</div>
</div>
<div class="divider-h"></div>
<div class="kpis">
<div class="kpi">
<div class="kpi-k">% plan executable</div>
<div class="kpi-v" id="tlPercent">â€”</div>
<div class="kpi-s">Based on optimizer-required attempts vs executable attempts</div>
</div>
<div class="kpi">
<div class="kpi-k">Projected completion week</div>
<div class="kpi-v" id="tlCompletionWeek">â€”</div>
<div class="kpi-s">Slowest tactic under weekly capacity</div>
</div>
<div class="kpi">
<div class="kpi-k">Shortfall attempts</div>
<div class="kpi-v" id="tlShortfallAttempts">â€”</div>
<div class="kpi-s">0 if fully executable</div>
</div>
<div class="kpi">
<div class="kpi-k">Constraint type</div>
<div class="kpi-v" id="tlConstraint">â€”</div>
<div class="kpi-s">Timeline can override budget/capacity feasibility</div>
</div>
</div>
<div class="grid2" style="margin-top:10px;">
<div class="field">
<label class="label">Shortfall net votes (est.)</label>
<div class="metric-v" id="tlShortfallVotes">â€”</div>
<div class="note">Uses optimizerâ€™s blended votes/attempt (objective-aligned) when available.</div>
</div>
<div class="field">
<label class="label">Weekly distribution preview</label>
<pre class="week-list" id="tlWeekList">â€”</pre>
<div class="note">Preview only (does not re-optimize or time-simulate Monte Carlo).</div>
</div>
</div>
<div class="card card-readonly" id="decisionIntelCard">
<div class="card-head card-header">
<h2 class="card-title">Decision intelligence</h2>
</div>
<div class="banner warn" hidden="" id="diWarn"></div>
<div class="grid2" style="margin-top:10px;">
<div>
<div class="muted" style="font-size:12px; margin-bottom:6px;">Bottleneck summary</div>
<div class="rowline" style="gap:10px; align-items:flex-start;">
<div style="min-width:140px;">
<div class="muted" style="font-size:11px;">Primary</div>
<div id="diPrimary" style="font-weight:650;">â€”</div>
</div>
<div style="min-width:140px;">
<div class="muted" style="font-size:11px;">Secondary</div>
<div id="diSecondary" style="font-weight:650;">â€”</div>
</div>
<div style="flex:1;">
<div class="muted" style="font-size:11px;">Not binding</div>
<div class="muted" id="diNotBinding">â€”</div>
</div>
</div>
</div>
<div>
<div class="muted" style="font-size:12px; margin-bottom:6px;">Recommendations</div>
<div class="note" id="diRecVol">â€”</div>
<div class="note" id="diRecCost" style="margin-top:6px;">â€”</div>
<div class="note" id="diRecProb" style="margin-top:6px;">â€”</div>
</div>
</div>
<div class="grid3" style="margin-top:12px;">
<div class="table-wrap">
<table class="table">
<thead>
<tr><th>Top levers â€” Volunteer load</th><th class="num">Î” volunteers</th></tr>
</thead>
<tbody id="diVolTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="table-wrap">
<table class="table">
<thead>
<tr><th>Top levers â€” Cost</th><th class="num">Î” cost</th></tr>
</thead>
<tbody id="diCostTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
<div class="table-wrap">
<table class="table">
<thead>
<tr><th>Top levers â€” Win probability</th><th class="num">Î” prob</th></tr>
</thead>
<tbody id="diProbTbody">
<tr><td class="muted">â€”</td><td class="num muted">â€”</td></tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="banner warn" hidden="" id="tlBanner"></div>
</div>
</div></section>

<!-- â”€â”€ STAGE: checks â”€â”€ -->
<section class="stage-new" id="stage-checks">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Stage 9</span>
<span class="stage-title-new">Checks &amp; guardrails</span>
</div>
<p class="stage-sub-new">Validate inputs, inspect assumptions snapshot, and review guardrails. The most dangerous failures are silent ones.</p>
<div class="training-panel-new" id="train-checks">
<div class="training-hd-new" onclick="toggleTrainPanel('train-checks')">
<span>ðŸŽ“</span><span class="training-title-new">Training â€” Validation &amp; Guardrails</span><span class="training-chev-new">â–¾</span>
</div>
<div class="training-bd-new">
<div class="training-col-new">
<div class="training-sec-title-new">What this stage does</div>
<p>Guardrails catch invalid states and "looks plausible but impossible" plans before you share them with a client or campaign. The assumptions snapshot freezes key parameters so you can detect drift between runs.</p>
</div>
<div class="training-col-new">
<div class="training-sec-title-new">When to use it</div>
<ul>
<li>Before every client presentation â€” run checks first</li>
<li>When results look surprisingly good â€” check guardrails</li>
<li>After importing a scenario from another session</li>
</ul>
</div>
</div>
</div>
</div>
<div class="stage-body-new">
  <div class="note">Key assumptions, checks, and guardrails are shown in the right rail for persistent visibility.</div>
</div></section>
<section class="panel" id="tab-roi">

</section>
<!-- â”€â”€ STAGE: scenarios â”€â”€ -->
<section class="stage-new" id="stage-scenarios">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Decisions</span>
<span class="stage-title-new">Scenarios</span>
</div>
<p class="stage-sub-new">Save, compare, and switch between planning scenarios. Use this to model Path A vs Path B before committing resources.</p>
</div>
<div class="stage-body-new">
<div class="card card-section phase-scenarios" id="scenarioCompareCard">
<div class="card-head card-header">
<h2 class="card-title">Scenario Compare</h2>
</div>
<div class="banner warn" hidden="" id="scWarn"></div>
<div class="scm">
<div class="rowline scm-active">
<div class="note" id="activeScenarioLabel">Active Scenario: â€”</div>
</div>
<div class="scm-row">
<div class="scm-field">
<label class="label" for="scenarioSelect">Scenarios</label>
<select class="select select-sm" id="scenarioSelect"></select>
</div>
<div class="scm-field">
<label class="label" for="scenarioNewName">New scenario</label>
<input class="input input-sm" id="scenarioNewName" placeholder="e.g., Path A â€” full GOTV" type="text"/>
</div>
</div>
<div class="rowline scm-actions">
<button class="btn btn-sm" id="btnScenarioSaveNew" type="button">Save as new scenario</button>
<button class="btn btn-sm btn-ghost" id="btnScenarioCloneBaseline" type="button">Clone baseline</button>
<button class="btn btn-sm" id="btnScenarioLoadSelected" type="button">Load selected</button>
<button class="btn btn-sm btn-ghost" id="btnScenarioReturnBaseline" type="button">Return to baseline</button>
<button class="btn btn-sm btn-ghost" id="btnScenarioDelete" type="button">Delete scenario</button>
</div>
<div aria-hidden="true" class="sc-divider" role="separator"></div>
</div>
<div class="scm-compare" id="scmCompareWrap">
<div class="rowline" style="justify-content:space-between; align-items:flex-end; gap:12px;">
<div>
<div class="note" style="font-weight:600;">Scenario Comparison</div>
<div class="muted" style="font-size:12px;">Baseline vs active scenario (inputs + key outputs).</div>
</div>
<div class="tag" id="scmCompareTag">â€”</div>
</div>
<div class="scm-compare-empty muted" id="scmCompareEmpty" style="font-size:12px; margin-top:8px;">Select a non-baseline active scenario to view differences.</div>
<div class="scm-compare-grid" hidden="" id="scmCompareGrid">
<div class="scm-compare-col">
<div class="note" style="margin-bottom:6px;">Input Differences</div>
<ul class="diff-list" id="scmDiffInputs"></ul>
<div class="muted" id="scmDiffInputsFoot" style="font-size:12px; margin-top:6px;"></div>
</div>
<div class="scm-compare-col">
<div class="note" style="margin-bottom:6px;">Output Differences</div>
<div class="table-wrap">
<table class="table">
<thead>
<tr>
<th style="min-width:150px;">Metric</th>
<th style="min-width:110px;">Baseline</th>
<th style="min-width:110px;">Scenario</th>
<th style="min-width:110px;">Delta</th>
</tr>
</thead>
<tbody id="scmDiffOutputs"></tbody>
</table>
</div>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator" style="margin-top:10px;"></div>
</div>
<div class="sc-controls">
<div class="scenario">
<label class="label" for="scenarioName">Scenario</label>
<input class="input input-sm" id="scenarioNameStage" placeholder="e.g., IL HD-XX â€” Primary Path" type="text"/>
</div>
<div class="sc-actions">
<button class="btn btn-sm" id="btnSaveJson" type="button">Export Scenario</button>
<label class="btn btn-sm btn-ghost" for="loadJson">Import Scenario</label>
<input accept="application/json" hidden="" id="loadJson" type="file"/>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator"></div>
<div class="rowline sc-meta">
<button class="btn btn-sm" id="btnSaveScenario" type="button">Save Current Scenario</button>
<div class="muted" style="font-size:12px;">Saved scenarios are session-only (memory). Max 5.</div>
</div>
<div class="table-wrap" style="margin-top:10px;">
<table class="table">
<thead>
<tr>
<th style="min-width:180px;">Scenario</th>
<th style="min-width:120px;">Label</th>
<th style="min-width:110px;">Volunteers</th>
<th style="min-width:110px;">Cost</th>
<th style="min-width:90px;">Win %</th>
<th style="min-width:160px;">Primary bottleneck</th>
<th style="min-width:90px;"></th>
</tr>
</thead>
<tbody id="scCompareTbody">
<tr><td class="muted" colspan="7">No scenarios saved yet.</td></tr>
</tbody>
</table>
</div>
<div class="note sc-overall" id="scOverall">Most efficient scenario overall: â€”</div>
</div>
<div class="card card-section phase-decision" id="decisionSessionCard">
<div class="card-head card-header">
<h2 class="card-title">Decision Session</h2>
</div>
</div></div></section>
<!-- â”€â”€ STAGE: decisions â”€â”€ -->
<section class="stage-new" id="stage-decisions">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Decisions</span>
<span class="stage-title-new">Decision sessions</span>
</div>
<p class="stage-sub-new">Structured decision framework: objectives, constraints, options, and recommendation. Makes tradeoffs explicit.</p>
</div>
<div class="stage-body-new">
</div>
<div class="scm">
<div class="rowline scm-active">
<div class="note" id="decisionActiveLabel">Active session: â€”</div>
</div>
<div class="scm-row">
<div class="scm-field">
<label class="label" for="decisionSessionSelect">Sessions</label>
<select class="select select-sm" id="decisionSessionSelect"></select>
</div>
<div class="scm-field" style="align-self:flex-end;">
<button class="btn btn-sm" id="btnDecisionNew" type="button">New session</button>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionRename">Rename session</label>
<input class="input input-sm" id="decisionRename" placeholder="e.g., Week 2 client call" type="text"/>
</div>
<div class="scm-field" style="align-self:flex-end; display:flex; gap:8px; justify-content:flex-end;">
<button class="btn btn-sm btn-ghost" id="btnDecisionRenameSave" type="button">Save</button>
<button class="btn btn-sm btn-ghost" id="btnDecisionDelete" type="button">Delete</button>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator" style="margin-top:10px;"></div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionObjective">Objective</label>
<select class="select select-sm" id="decisionObjective"></select>
</div>
<div class="scm-field" style="align-self:flex-end; display:flex; flex-direction:column; gap:6px; align-items:flex-end;">
<button class="btn btn-sm btn-ghost" id="btnDecisionLinkScenario" type="button">Link to active scenario</button>
<div class="muted" id="decisionScenarioLabel" style="font-size:12px; text-align:right;">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<label class="label" for="decisionNotes">Notes</label>
<textarea class="input" id="decisionNotes" placeholder="Short notes..." rows="5"></textarea>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator" style="margin-top:10px;"></div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0;">Assumptions &amp; constraints</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionBudget">Budget cap ($)</label>
<input class="input input-sm" id="decisionBudget" inputmode="decimal" placeholder="e.g., 15000" type="text"/>
</div>
<div class="scm-field">
<label class="label" for="decisionVolunteerHrs">Volunteer hrs/week</label>
<input class="input input-sm" id="decisionVolunteerHrs" inputmode="decimal" placeholder="e.g., 120" type="text"/>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionTurfAccess">Turf access</label>
<select class="select select-sm" id="decisionTurfAccess">
<option value="">Unknown</option>
<option value="full">Full</option>
<option value="limited">Limited</option>
<option value="none">None</option>
</select>
</div>
<div class="scm-field">
<label class="label" for="decisionBlackoutDates">Blackout dates</label>
<input class="input input-sm" id="decisionBlackoutDates" placeholder="e.g., 3/5â€“3/8, 4/1" type="text"/>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionRiskPosture">Risk posture</label>
<select class="select select-sm" id="decisionRiskPosture"></select>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<label class="label" for="decisionNonNegotiables">Non-negotiables (one per line)</label>
<textarea class="input" id="decisionNonNegotiables" placeholder="e.g., Must finish by 5/1
Must hit 12,000 doors" rows="4"></textarea>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator" style="margin-top:10px;"></div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0;">Options</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionOptionSelect">Option</label>
<select class="select select-sm" id="decisionOptionSelect"></select>
</div>
<div class="scm-field" style="align-self:flex-end;">
<button class="btn btn-sm" id="btnDecisionOptionNew" type="button">New option</button>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionOptionRename">Rename option</label>
<input class="input input-sm" id="decisionOptionRename" placeholder="e.g., Path 1: Volunteer-heavy" type="text"/>
</div>
<div class="scm-field" style="align-self:flex-end; display:flex; gap:8px; justify-content:flex-end;">
<button class="btn btn-sm btn-ghost" id="btnDecisionOptionRenameSave" type="button">Save</button>
<button class="btn btn-sm btn-ghost" id="btnDecisionOptionDelete" type="button">Delete</button>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%; display:flex; gap:10px; justify-content:space-between; align-items:flex-end;">
<div class="muted" id="decisionOptionScenarioLabel" style="font-size:12px;">â€”</div>
<button class="btn btn-sm btn-ghost" id="btnDecisionOptionLinkScenario" type="button">Link option to active scenario</button>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="muted" style="font-size:12px; margin-bottom:6px;">Tactics tags (UI only)</div>
<div class="tacticRow">
<label class="tacticToggle"><input id="decisionOptionTacticDoors" type="checkbox"/>Doors</label>
<label class="tacticToggle"><input id="decisionOptionTacticPhones" type="checkbox"/>Phones</label>
<label class="tacticToggle"><input id="decisionOptionTacticDigital" type="checkbox"/>Digital</label>
</div>
</div>
</div>
<div aria-hidden="true" class="sc-divider" role="separator" style="margin-top:10px;"></div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0;">Decision Summary</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0; display:flex; align-items:center; justify-content:space-between; gap:10px;">
<span>Assumption Drift</span>
<span class="tag" id="driftStatusTag">â€”</span>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="kpis" style="grid-template-columns:1fr 1fr 1fr;">
<div class="mini">
<div class="mini-k">Required attempts/week</div>
<div class="mini-v" id="driftReq">â€”</div>
<div class="mini-s" id="driftReqNote">From current assumptions</div>
</div>
<div class="mini">
<div class="mini-k">Actual attempts (last 7)</div>
<div class="mini-v" id="driftActual">â€”</div>
<div class="mini-s" id="driftActualNote">From daily log</div>
</div>
<div class="mini">
<div class="mini-k">Delta</div>
<div class="mini-v" id="driftDelta">â€”</div>
<div class="mini-s" id="driftDeltaNote">Actual vs required</div>
</div>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="banner" id="driftSlipBanner">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0; display:flex; align-items:center; justify-content:space-between; gap:10px;">
<span>Risk Framing</span>
<span class="tag" id="riskBandTag">â€”</span>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="kpis" style="grid-template-columns:1fr 1fr 1fr;">
<div class="mini">
<div class="mini-k">Win probability</div>
<div class="mini-v" id="riskWinProb">â€”</div>
<div class="mini-s">From Monte Carlo</div>
</div>
<div class="mini">
<div class="mini-k">Expected margin band</div>
<div class="mini-v" id="riskMarginBand">â€”</div>
<div class="mini-s">Central interval</div>
</div>
<div class="mini">
<div class="mini-k">Volatility</div>
<div class="mini-v" id="riskVolatility">â€”</div>
<div class="mini-s">Range width</div>
</div>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="banner" id="riskPlainBanner">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0; display:flex; align-items:center; justify-content:space-between; gap:10px;">
<span>Bottleneck Attribution</span>
<span class="tag" id="bneckTag">â€”</span>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="kpis" style="grid-template-columns:1fr 1fr;">
<div class="mini">
<div class="mini-k">Primary</div>
<div class="mini-v" id="bneckPrimary">â€”</div>
<div class="mini-s">What is binding now</div>
</div>
<div class="mini">
<div class="mini-k">Secondary</div>
<div class="mini-v" id="bneckSecondary">â€”</div>
<div class="mini-s">Next-most binding</div>
</div>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="tableWrap" style="overflow:auto;">
<table class="table" style="min-width:640px;">
<thead>
<tr>
<th>Constraint</th>
<th class="num">If +10%</th>
<th class="muted">Notes</th>
</tr>
</thead>
<tbody id="bneckTbody"></tbody>
</table>
</div>
<div class="muted" id="bneckWarn" style="font-size:12px; margin-top:8px;">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0; display:flex; align-items:center; justify-content:space-between; gap:10px;">
<span>Sensitivity Snapshot</span>
<div style="display:flex; align-items:center; gap:8px;">
<span class="tag" id="sensTag">â€”</span>
<button class="btn btn-sm btn-ghost" id="btnSensRun" type="button">Run snapshot</button>
</div>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="tableWrap" style="overflow:auto;">
<table class="table" style="min-width:640px;">
<thead>
<tr>
<th>Perturbation</th>
<th class="num">Î” win prob</th>
<th class="num">Î” p50 margin</th>
<th class="muted">Notes</th>
</tr>
</thead>
<tbody id="sensTbody"></tbody>
</table>
</div>
<div class="banner" id="sensBanner" style="margin-top:10px;">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="note" style="margin:0; display:flex; align-items:center; justify-content:space-between; gap:10px;">
<span>Decision Confidence</span>
<span class="tag" id="confTag">â€”</span>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="kpis" style="grid-template-columns:1fr 1fr 1fr 1fr;">
<div class="mini">
<div class="mini-k">Execution pace</div>
<div class="mini-v" id="confExec">â€”</div>
<div class="mini-s">From daily log</div>
</div>
<div class="mini">
<div class="mini-k">Risk band</div>
<div class="mini-v" id="confRisk">â€”</div>
<div class="mini-s">From Monte Carlo</div>
</div>
<div class="mini">
<div class="mini-k">Constraint tightness</div>
<div class="mini-v" id="confTight">â€”</div>
<div class="mini-s">Timeline/budget/capacity</div>
</div>
<div class="mini">
<div class="mini-k">Scenario divergence</div>
<div class="mini-v" id="confDiv">â€”</div>
<div class="mini-s">Baseline vs active</div>
</div>
</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<div class="banner" id="confBanner">â€”</div>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field">
<label class="label" for="decisionRecommendSelect">Recommended option</label>
<select class="select select-sm" id="decisionRecommendSelect"></select>
</div>
<div class="scm-field"></div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<label class="label" for="decisionWhatTrue">What needs to be true (one per line)</label>
<textarea class="input" id="decisionWhatTrue" placeholder="e.g., Contact rate holds at 22%
Volunteer multiplier stays above 1.5" rows="4"></textarea>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%;">
<label class="label" for="decisionSummaryPreview">Client-ready summary (preview)</label>
<textarea class="input mono" id="decisionSummaryPreview" readonly="" rows="14"></textarea>
</div>
</div>
<div class="scm-row" style="margin-top:10px;">
<div class="scm-field" style="width:100%; display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:center;">
<div class="muted" id="decisionCopyStatus" style="margin-right:auto; font-size:12px;"></div>
<button class="btn btn-sm btn-ghost" id="btnDecisionCopyMd" type="button">Copy markdown</button>
<button class="btn btn-sm btn-ghost" id="btnDecisionCopyText" type="button">Copy text</button>
<button class="btn btn-sm btn-ghost" id="btnDecisionDownloadJson" type="button">Download JSON</button>
</div>
</div>
</div>
</section>
<!-- â”€â”€ STAGE: integrity â”€â”€ -->
<section class="stage-new" id="stage-integrity">
<div class="stage-header-new">
<div class="stage-meta-new">
<span class="stage-tag-new">Integrity</span>
<span class="stage-title-new">Integrity &amp; export</span>
</div>
<p class="stage-sub-new">Snapshot hash, import/export, and data integrity. Ensures an exported scenario re-imports to the same result.</p>
</div>
<div class="stage-body-new">
</div>
</section>
</main>
<!-- /stage-main-new -->
<!-- RIGHT: Persistent results sidebar -->
<aside aria-label="Win path results" class="results-sidebar-new">
<!-- WIN PATH KPIs (existing IDs, just repositioned) -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Win path â€” expected</div>
<div class="win-stat-new">
<span class="win-stat-label-new">Turnout votes</span>
<span class="win-stat-val-new" id="kpiTurnoutVotes-sidebar">â€”</span>
<span class="win-stat-sub-new" id="kpiTurnoutBand-sidebar">â€”</span>
</div>
<div class="win-stat-new">
<span class="win-stat-label-new">Win threshold</span>
<span class="win-stat-val-new" id="kpiWinThreshold-sidebar">â€”</span>
</div>
<div class="win-stat-new">
<span class="win-stat-label-new">Your projected votes</span>
<span class="win-stat-val-new" id="kpiYourVotes-sidebar">â€”</span>
<span class="win-stat-sub-new" id="kpiYourVotesShare-sidebar">â€”</span>
</div>
<div class="win-stat-new">
<span class="win-stat-label-new">Persuasion votes needed</span>
<span class="win-stat-val-new" id="kpiPersuasionNeed-sidebar">â€”</span>
<span class="win-stat-sub-new" id="kpiPersuasionStatus-sidebar">â€”</span>
</div>
</div>
<!-- MC WIN PROBABILITY -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Monte Carlo â€” win probability</div>
<div class="mc-prob-row-new">
<span class="mc-prob-val-new" id="mcWinProb-sidebar">â€”</span>
<span class="mc-prob-sub-new">simulated</span>
</div>
<svg aria-label="Win probability" class="prob-bar-new" height="14" id="svgWinProb" role="img" viewbox="0 0 300 14" width="300">
<rect class="viz-track" height="2" rx="1" width="300" x="0" y="6"></rect>
<circle class="viz-marker" cx="0" cy="7" id="svgWinProbMarker" r="5"></circle>
</svg>
<div class="muted" id="vizWinProbNote" style="font-size:11px; margin-top:6px;">â€”</div>
<div class="prob-range-new">
<span id="mcP10-sidebar">P10: â€”</span>
<span id="mcP50-sidebar">Median: â€”</span>
<span id="mcP90-sidebar">P90: â€”</span>
</div>
<div class="mc-meta-new">
<span id="mcFreshTag-sidebar">â€”</span> Â |Â  <span id="mcLastRun-sidebar">â€”</span>
</div>
<div class="banner warn" hidden="" id="mcStale-sidebar">Results may be stale â€” re-run Monte Carlo</div>
<div style="margin-top:8px; display:flex; gap:6px;">
<button class="btn btn-sm" id="mcRun-sidebar" type="button">Run Monte Carlo</button>
<button class="btn btn-sm btn-ghost" id="mcRerun-sidebar" type="button">Re-run</button>
</div>
</div>
<!-- VALIDATION CHECKS -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Input validation</div>
<ul class="validation" id="validationList-sidebar"></ul>
</div>

<!-- ASSUMPTIONS SNAPSHOT -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Key assumptions</div>
<div class="assumptions" id="assumptionsSnapshot"></div>
</div>

<!-- DATA CHECKS & GUARDRAILS -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Data checks &amp; guardrails</div>
<div class="guardrails" id="guardrails"></div>
</div>

<!-- STRESS TEST (CLIENT STYLE) -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Stress test summary</div>
<div class="stress" id="stressBox">
<div class="stress-item">â€”</div>
</div>
</div>
<!-- EARLY VOTE MINI -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Early &amp; election day split</div>
<div class="kv-mini-new"><span>Early votes (expected)</span><span id="miniEarlyVotes-sidebar">â€”</span></div>
<div class="kv-mini-new"><span>Election day votes</span><span id="miniEDVotes-sidebar">â€”</span></div>
<div class="kv-mini-new"><span>Note</span><span id="miniEarlyNote-sidebar">â€”</span></div>
<div class="kv-mini-new"><span>Persuasion universe</span><span id="miniPersUniverse-sidebar">â€”</span></div>
<div class="kv-mini-new"><span>Universe check</span><span id="miniPersCheck-sidebar">â€”</span></div>
</div>
<!-- RISK TAG -->
<div class="sidebar-section-new">
<div class="sidebar-label-new">Risk framing</div>
<div style="display:flex; align-items:center; gap:8px; margin-bottom:6px;">
<span class="badge" id="riskBandTag-sidebar">â€”</span>
<span class="muted" id="riskWinProb-sidebar" style="font-size:11px;">â€”</span>
</div>
<svg aria-label="Margin distribution" height="88" id="svgMargin" role="img" style="margin:8px 0 6px;" viewbox="0 0 300 88" width="300">
<g id="svgMarginWinShade"></g>
<g id="svgMarginBars"></g>
<line class="viz-zero" id="svgMarginZero" x1="150" x2="150" y1="12" y2="76"></line>
</svg>
<div class="prob-range-new" style="margin-bottom:8px;">
<span id="svgMarginMin">â€”</span>
<span id="svgMarginMax">â€”</span>
</div>
<div class="kv-mini-new"><span>Margin band</span><span id="riskMarginBand-sidebar">â€”</span></div>
<div class="kv-mini-new"><span>Volatility</span><span id="riskVolatility-sidebar">â€”</span></div>
<div class="banner" hidden="" id="riskPlainBanner-sidebar"></div>
</div>
<!-- SNAPSHOT HASH -->
<div class="sidebar-section-new" style="margin-top:auto; border-top: 1px solid var(--rule);">
<div class="sidebar-label-new">Snapshot hash</div>
<div class="kv-mini-new dim-text"><span id="snapshotHash-sidebar">â€”</span></div>
</div>
</aside>
</div>
<!-- /app-shell -->
<script src="./js/app.js?v=20260222-d4" type="module"></script>
<script>
// â”€â”€ Stage navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function normalizeStages() {
  var host = document.querySelector('.stage-main-new');
  if (!host) return;
  var stages = Array.from(document.querySelectorAll('.stage-new'));
  stages.forEach(function(sec){ host.appendChild(sec); });
}

function switchStage(btn, stageId) {
  // Nav items
  document.querySelectorAll('.nav-item-new').forEach(el => el.classList.remove('active'));
  btn.classList.add('active');

  // Stage panels
  document.querySelectorAll('.stage-new').forEach(el => el.classList.remove('active-stage'));
  var target = document.getElementById('stage-' + stageId);
  if (target) target.classList.add('active-stage');
}

// â”€â”€ Training panel collapse/expand â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleTrainPanel(id) {
  var el = document.getElementById(id);
  if (el) el.classList.toggle('collapsed');
}

document.addEventListener('DOMContentLoaded', function(){
  normalizeStages();
});
</script>
<div class="modal" hidden="" id="diagModal">
<div class="modal-backdrop" data-close="1"></div>
<div aria-labelledby="diagTitle" aria-modal="true" class="modal-card" role="dialog">
<div class="modal-head">
<div class="modal-title" id="diagTitle">Diagnostics</div>
<button class="btn btn-sm btn-ghost" id="btnDiagClose" type="button">Close</button>
</div>
<div class="modal-body">
<div class="muted" style="margin-bottom:8px;">Recent errors (last 20, this session only)</div>
<div class="mono diag-errors" id="diagErrors"></div>
</div>
<div class="modal-foot">
<button class="btn btn-sm" id="btnCopyDebug" type="button">Copy debug bundle</button>
</div>
</div>
</div>
</body>
</html>
